def XHquadsecond(x, C, γ, dt):
    p, q, s = x
    a = (
        p
        + (1.0 / 24.0)
        * (
            -γ * p ** 3
            + 2 * q * s * γ
            + p * (-2 + γ * (q ** 2 + 3 * γ * s ** 2 - 2 * C))
        )
        * dt ** 2
    )
    b = (-q - p * s * γ) + (1 / 48) * (
        -4 * γ * q ** 3
        + p * s * (γ * q) ** 2
        - 2 * p * s * γ * (2 + 3 * γ * p ** 2 + γ * C)
        + q * (-8 + γ * (-6 * p ** 2 + γ * s ** 2 + 8 * C))
    ) * dt ** 2
    c = (
        (p ** 2 - q ** 2 - s ** 2 * γ) / 2.0
        + C
        + (
            (
                -8 * q ** 2
                - 3 * p ** 4 * γ
                + 2 * p ** 2 * (-2 + γ * (q ** 2 + 3 * s ** 2 * γ - 2 * C))
                - γ * (q ** 2 - 2 * C) * (-2 * q ** 2 + s ** 2 * γ + 4 * C)
            )
            * dt ** 2
        )
        / 96
    )
    return [a, b, c]


def XHquadforth(x, C, γ, dt):
    a, b, c = XHquadsecond(x, C, γ, dt)
    p, q, s = x
    a += (
        (
            -9 * p ** 5 * γ ** 2
            + 186 * p ** 2 * q * s * γ ** 2
            - 4 * q * s * γ * (-8 + γ * (q ** 2 + 5 * s ** 2 * γ - 2 * C))
            + -3 * p ** 3 * γ * (-8 + 5 * γ * (q ** 2 + 8 * s ** 2 * γ - 2 * C))
            - -p
            * (
                16
                + γ
                * (
                    q ** 4 * γ
                    + 20 * s ** 4 * γ ** 3
                    + q ** 2 * (-40 + 30 * s ** 2 * γ ** 2 - 4 * γ * C)
                    + 4 * C * (-4 + γ * C)
                    - -30 * s ** 2 * γ * (1 + 2 * γ * C)
                )
            )
        )
        * dt ** 4
    ) / 1920.0
    b += (
        -(
            (
                -24 * q ** 5 * γ ** 2
                + 2 * p * q ** 4 * s * γ ** 3
                + 4 * p * q ** 2 * s * γ ** 2 * (18 + 15 * p ** 2 * γ - 2 * γ * C)
                + -4 * q ** 3 * γ * (-48 + γ * (3 * p ** 2 + s ** 2 * γ + 24 * C))
                + -8
                * p
                * s
                * γ
                * (
                    -8
                    + γ
                    * (
                        -15 * p ** 4 * γ
                        + 5 * s ** 2 * γ
                        + p ** 2 * (-23 + 5 * γ * (2 * s ** 2 * γ - 3 * C))
                        + C * (-2 + γ * C)
                    )
                )
                - -q
                * (
                    128
                    + γ
                    * (
                        139 * p ** 4 * γ
                        + 8 * s ** 2 * γ * (-6 + γ * C)
                        + 96 * C * (-2 + γ * C)
                        + 12 * p ** 2 * (12 - 15 * s ** 2 * γ ** 2 + 2 * γ * C)
                    )
                )
            )
            * -(dt ** 4)
        )
        / 3840.0
    )
    c += (
        -(
            (
                -30 * p ** 6 * γ ** 2
                - 8 * q ** 6 * γ ** 2
                + 496 * p ** 3 * q * s * γ ** 2
                + 9 * p ** 4 * γ * (-8 + 5 * γ * (q ** 2 + 8 * s ** 2 * γ - 2 * C))
                + -8 * γ ** 2 * C ** 2 * (s ** 2 * γ + 8 * C)
                + 2 * q ** 4 * γ * (-48 + s ** 2 * γ ** 2 + 24 * γ * C)
                - -8
                * q ** 2
                * (16 + γ * (s ** 2 * γ * (-6 + γ * C) + 12 * C * (-2 + γ * C)))
                - -2
                * p ** 2
                * (
                    16
                    + γ
                    * (
                        q ** 4 * γ
                        + 20 * s ** 4 * γ ** 3
                        + q ** 2 * (-40 + 30 * s ** 2 * γ ** 2 - 4 * γ * C)
                        + 4 * C * (-4 + γ * C)
                        - -30 * s ** 2 * γ * (1 + 2 * γ * C)
                    )
                )
            )
            * dt ** 4
        )
        / 7680.0
    )
    return [a, b, c]


def XHquadsixth(x, C, γ, dt):
    a, b, c = XHquadforth(x, C, γ, dt)
    p, q, s = x
    a += (
        -(
            (
                -608 * p ** 7 * γ ** 3
                + 28920 * p ** 4 * q * s * γ ** 3
                + 84
                * p ** 5
                * γ ** 2
                * (-29 + 3 * γ * (5 * q ** 2 + 64 * s ** 2 * γ - 10 * C))
                + -48
                * p ** 2
                * q
                * s
                * γ ** 2
                * (446 + γ * (-223 * q ** 2 - 606 * s ** 2 * γ + 446 * C))
                + -8
                * q
                * s
                * γ
                * (
                    192
                    + γ
                    * (
                        36 * q ** 4 * γ
                        + 112 * s ** 4 * γ ** 3
                        + q ** 2 * (-320 + 3 * γ * (49 * s ** 2 * γ - 48 * C))
                        + 48 * C * (1 + 3 * γ * C)
                        - -14 * s ** 2 * γ * (16 + 21 * γ * C)
                    )
                )
                + -2
                * p
                * (
                    -256
                    + γ
                    * (
                        24 * q ** 6 * γ ** 2
                        + 560 * s ** 6 * γ ** 5
                        - 112 * s ** 4 * γ ** 3 * (9 + 20 * γ * C)
                        - -64 * C * (-6 + γ * C * (10 + 3 * γ * C))
                        + q ** 4 * γ * (441 * s ** 2 * γ ** 2 - 16 * (83 + 9 * γ * C))
                        + -84 * s ** 2 * γ * (8 + γ * C * (20 + 21 * γ * C))
                        + -4
                        * q ** 2
                        * (
                            384
                            + 280 * s ** 4 * γ ** 4
                            + 24 * γ * C * (31 + 3 * γ * C)
                            - 3 * s ** 2 * γ ** 2 * (790 + 147 * γ * C)
                        )
                    )
                )
                - -4
                * p ** 3
                * γ
                * (
                    272
                    + γ
                    * (
                        147 * q ** 4 * γ
                        + 12 * q ** 2 * (-304 + 7 * γ * (33 * s ** 2 * γ - 7 * C))
                        + -4
                        * (
                            924 * s ** 4 * γ ** 3
                            + C * (220 + 147 * γ * C)
                            - 6 * s ** 2 * γ * (179 + 231 * γ * C)
                        )
                    )
                )
            )
            * dt ** 6
        )
        / 430080.0
    )
    b += (
        +(
            (
                -96 * q ** 7 * γ ** 3
                + 4 * p * q ** 6 * s * γ ** 4
                - p * q ** 4 * s * γ ** 3 * (784 + 441 * p ** 2 * γ + 24 * γ * C)
                + -12
                * q ** 5
                * γ ** 2
                * (-172 + γ * (-18 * p ** 2 + s ** 2 * γ + 48 * C))
                + -4
                * p
                * q ** 2
                * s
                * γ ** 2
                * (
                    1200
                    + γ
                    * (
                        693 * p ** 4 * γ
                        - 623 * s ** 2 * γ
                        + 4 * C * (116 + 3 * γ * C)
                        + -(p ** 2) * (3708 + 7 * γ * (-80 * s ** 2 * γ + 63 * C))
                    )
                )
                - -2
                * q ** 3
                * γ
                * (
                    2304
                    + γ
                    * (
                        -1039 * p ** 4 * γ
                        + 3 * p ** 2 * (-656 + 9 * γ * (49 * s ** 2 * γ - 16 * C))
                        + -8
                        * (s ** 2 * γ * (8 + 3 * γ * C) + 8 * C * (-43 + 9 * γ * C))
                    )
                )
                + -2
                * q
                * (
                    -768
                    + γ
                    * (
                        -1551 * p ** 6 * γ ** 2
                        - 182 * s ** 4 * γ ** 3
                        + 2
                        * p ** 4
                        * γ
                        * (-1804 + 4329 * s ** 2 * γ ** 2 - 1039 * γ * C)
                        + -8 * s ** 2 * γ * (60 + γ * C * (8 + 3 * γ * C))
                        + 32 * C * (48 + γ * C * (-43 + 12 * γ * C))
                        - -6
                        * p ** 2
                        * (
                            280 * s ** 4 * γ ** 4
                            + 24 * (1 + γ * C) * (8 + 3 * γ * C)
                            - 3 * s ** 2 * γ ** 2 * (338 + 147 * γ * C)
                        )
                    )
                )
                + -4
                * p
                * s
                * γ
                * (
                    -192
                    + γ
                    * (
                        -672 * p ** 6 * γ ** 2
                        + 3 * p ** 4 * γ * (-599 + 154 * γ * (4 * s ** 2 * γ - 3 * C))
                        - -(p ** 2)
                        * (
                            1060
                            + 420 * s ** 4 * γ ** 4
                            - 4 * s ** 2 * γ ** 2 * (429 + 280 * γ * C)
                            + γ * C * (1312 + 441 * γ * C)
                        )
                        - -2
                        * (
                            56 * s ** 4 * γ ** 3
                            - 7 * s ** 2 * γ * (16 + 21 * γ * C)
                            + 4 * C * (6 + γ * C * (18 + γ * C))
                        )
                    )
                )
            )
            * dt ** 6
        )
        / 215040.0
    )
    c += (
        -(
            (
                -532 * p ** 8 * γ ** 3
                + 23136 * p ** 5 * q * s * γ ** 3
                - 32
                * p ** 3
                * q
                * s
                * γ ** 2
                * (-446 + γ * (223 * q ** 2 + 606 * s ** 2 * γ - 446 * C))
                + -70
                * p ** 6
                * γ ** 2
                * (-29 + 3 * γ * (5 * q ** 2 + 64 * s ** 2 * γ - 10 * C))
                - -3
                * p ** 4
                * γ
                * (
                    272
                    + γ
                    * (
                        147 * q ** 4 * γ
                        + 12 * q ** 2 * (-304 + 7 * γ * (33 * C * γ - 7 * C))
                        + 880 * C
                        + -12
                        * γ
                        * (
                            308 * s ** 4 * γ ** 2
                            + 49 * C ** 2
                            - 2 * s ** 2 * (179 + 231 * γ * C)
                        )
                    )
                )
                + -4
                * (
                    -6 * q ** 8 * γ ** 3
                    - 8 * γ ** 3 * C ** 3 * (s ** 2 * γ + 12 * C)
                    + q ** 6 * γ ** 2 * (-172 + s ** 2 * γ ** 2 + 48 * γ * C)
                    - -2
                    * q ** 4
                    * γ
                    * (
                        288
                        + γ * (s ** 2 * γ * (8 + 3 * γ * C) + 8 * C * (-43 + 9 * γ * C))
                    )
                    + -(q ** 2)
                    * (
                        -384
                        + γ
                        * (
                            -91 * s ** 4 * γ ** 3
                            + 4 * s ** 2 * γ * (60 + γ * C * (8 + 3 * γ * C))
                            + 16 * C * (48 + γ * C * (-43 + 12 * γ * C))
                        )
                    )
                )
                - +(p ** 2)
                * (
                    -256
                    + γ
                    * (
                        24 * q ** 6 * γ ** 2
                        + 560 * s ** 6 * γ ** 5
                        - 112 * s ** 4 * γ ** 3 * (9 + 20 * γ * C)
                        - -64 * C * (-6 + γ * C * (10 + 3 * γ * C))
                        + q ** 4 * γ * (441 * s ** 2 * γ ** 2 - 16 * (83 + 9 * γ * C))
                        + -84 * s ** 2 * γ * (8 + γ * C * (20 + 21 * γ * C))
                        + -4
                        * q ** 2
                        * (
                            384
                            + γ
                            * (
                                280 * s ** 4 * γ ** 3
                                + 24 * C * (31 + 3 * γ * C)
                                - 3 * s ** 2 * γ * (790 + 147 * γ * C)
                            )
                        )
                    )
                )
            )
            * dt ** 6
        )
        / 430080.0
    )
    return [a, b, c]